// SerializeCounter converts Counter to []byte (TinyGo/WASM-safe)
func SerializeCounter(c *Counter) []byte {
	buf := make([]byte, 0)

	// Serialize count (int64 -> 8 bytes)
	countBytes := make([]byte, 8)
	binary.LittleEndian.PutUint64(countBytes, uint64(c.count))
	buf = append(buf, countBytes...)

	// Serialize owner string: length (uint32) + bytes
	ownerBytes := []byte(c.owner)
	ownerLen := make([]byte, 4)
	binary.LittleEndian.PutUint32(ownerLen, uint32(len(ownerBytes)))
	buf = append(buf, ownerLen...)
	buf = append(buf, ownerBytes...)

	return buf
}

// DeserializeCounter converts []byte back to Counter (TinyGo/WASM-safe)
func DeserializeCounter(data []byte) *Counter {
	c := &Counter{}

	// Read count (8 bytes)
	c.count = int(binary.LittleEndian.Uint64(data[:8]))

	// Read owner string length (4 bytes) and content
	strLen := binary.LittleEndian.Uint32(data[8:12])
	c.owner = string(data[12 : 12+strLen])

	return c
}
